<html>
    <head>
        <meta charset="UTF-8"> 
        <script src="../js/player.js"></script>
    </head>
    <body>
        <div>現在の周波数:<span id="frequency"></span></div>
        <div>現在の音程:<span id="pitch"></span></div>
        音程:<select id="interval">
            <option value="C1">C1</option>
            <option value="C#1">C#1</option>
            <option value="D1">D1</option>
            <option value="D#1">D#1</option>
            <option value="E1">E1</option>
            <option value="F1">F1</option>
            <option value="F#1">F#1</option>
            <option value="G1">G1</option>
            <option value="G#1">G#1</option>
            <option value="A1">A1</option>
            <option value="A#1">A#1</option>
            <option value="B1">B1</option>
            <option value="C2">C2</option>
            <option value="C#2">C#2</option>
            <option value="D2">D2</option>
            <option value="D#2">D#2</option>
            <option value="E2">E2</option>
            <option value="F2">F2</option>
            <option value="F#2">F#2</option>
            <option value="G2">G2</option>
            <option value="G#2">G#2</option>
            <option value="A2">A2</option>
            <option value="A#2">A#2</option>
            <option value="B2">B2</option>
            <option value="C3">C3</option>
            <option value="C#3">C#3</option>
            <option value="D3">D3</option>
            <option value="D#3">D#3</option>
            <option value="E3">E3</option>
            <option value="F3">F3</option>
            <option value="F#3">F#3</option>
            <option value="G3">G3</option>
            <option value="G#3">G#3</option>
            <option value="A3">A3</option>
            <option value="A#3">A#3</option>
            <option value="B3">B3</option>
            <option value="C4">C4</option>
            <option value="C#4">C#4</option>
            <option value="D4">D4</option>
            <option value="D#4">D#4</option>
            <option value="E4">E4</option>
            <option value="F4">F4</option>
            <option value="F#4">F#4</option>
            <option value="G4">G4</option>
            <option value="G#4">G#4</option>
            <option value="A4" selected>A4</option>
            <option value="A#4">A#4</option>
            <option value="B4">B4</option>
            <option value="C5">C5</option>
            <option value="C#5">C#5</option>
            <option value="D5">D5</option>
            <option value="D#5">D#5</option>
            <option value="E5">E5</option>
            <option value="F5">F5</option>
            <option value="F#5">F#5</option>
            <option value="G5">G5</option>
            <option value="G#5">G#5</option>
            <option value="A5">A5</option>
            <option value="A#5">A#5</option>
            <option value="B5">B5</option>
            <option value="C6">C6</option>
            <option value="C#6">C#6</option>
            <option value="D6">D6</option>
            <option value="D#6">D#6</option>
            <option value="E6">E6</option>
            <option value="F6">F6</option>
            <option value="F#6">F#6</option>
            <option value="G6">G6</option>
            <option value="G#6">G#6</option>
            <option value="A6">A6</option>
            <option value="A#6">A#6</option>
            <option value="B6">B6</option>
            <option value="C7">C7</option>
            <option value="C#7">C#7</option>
            <option value="D7">D7</option>
            <option value="D#7">D#7</option>
            <option value="E7">E7</option>
            <option value="F7">F7</option>
            <option value="F#7">F#7</option>
            <option value="G7">G7</option>
            <option value="G#7">G#7</option>
            <option value="A7">A7</option>
            <option value="A#7">A#7</option>
            <option value="B7">B7</option>
        </select><br>
        ボリューム:<select id="volume">
            <option value="0.1">1</option>
            <option value="0.2">2</option>
            <option value="0.3">3</option>
            <option value="0.4">4</option>
            <option value="0.5">5</option>
            <option value="0.6">6</option>
            <option value="0.7">7</option>
            <option value="0.8">8</option>
            <option value="0.9">9</option>
            <option value="1.0">10</option>
        </select><br>
        <input type="submit" value="鳴らす" id="submit"><br>
        <input type="submit" value="ランダムで鳴らす" id="randomSubmit"><br>
    </body> 
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script>
        window.addEventListener("load",function(){
            var playerOption = {
                sampleRate : 44100,
                channel : 1 ,
                streamLength : 4096,
                volume : 0.1,
            };
            var frequencyArray = [440];
            var player = new Player( new webkitAudioContext() , playerOption);
            var played = false;
            document.getElementById('submit').addEventListener("click" , function(){
                if(played){
                    player.stop();
                    played = false;
                    this.value = "鳴らす";
                }else{
                    var selected = $("#interval>option:selected").val();
                    var matches = selected.match(/(.*)(\d{1})/);
                    var scaleChars = matches[1];
                    var pitch = matches[2];
                    player.clearPitch();
                    player.setPitch(scaleChars , pitch);
                    player.addMajor3(scaleChars , pitch);
                    player.addMajor7(scaleChars , pitch);
                    $("#pitch").html(player.getPitchString());
                    $("#frequency").html(player.getFrequencyString());

                    var volume = $("#volume>option:selected").val();
                    player.changeVolume(volume);
                    player.play();
                    played = true;
                    this.value = "止める";
                }
            })

            document.getElementById('randomSubmit').addEventListener("click" , function(){
                if(played){
                    player.stop();
                    played = false;
                    this.value = "ランダムで鳴らす";
                }else{
                    player.clearPitch();
                    player.setRandomPitch();
                    $("#pitch").html(player.getPitchString());
                    $("#frequency").html(player.getFrequencyString());
                    var volume = $("#volume>option:selected").val();
                    player.changeVolume(volume);
                    player.play();
                    played = true;
                    this.value = "止める";
                }
            })

        })
    </script>
</html>
